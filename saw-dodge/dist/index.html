<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no, minimal-ui">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Saw Dodge</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --console-color: #6a4a8f;
            --console-color-dark: #5a3a7a;
            --console-color-light: #7a5a9f;
            --console-btn-color: #f0e6f5;
            --console-btn-dark: #d4c6df;
            --screen-border: #2a2a2a;
            --screen-bg: #f0e6f5;
            --danger-red: #c84040;
            --pixel-black: #1a1a1a;
        }

        html, body {
            overflow: hidden;
            width: 100%;
            height: 100%;
            background: #1a1a2e;
            font-family: 'Press Start 2P', monospace;
            touch-action: none;
            user-select: none;
            -webkit-user-select: none;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background 0.5s ease;
        }

        @media (pointer: coarse) {
            html, body {
                background: var(--console-color);
            }
        }

        /* Checkered background pattern on the console - inside container */

        #game-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(45deg, var(--console-color-dark) 25%, transparent 25%),
                linear-gradient(-45deg, var(--console-color-dark) 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, var(--console-color-dark) 75%),
                linear-gradient(-45deg, transparent 75%, var(--console-color-dark) 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            pointer-events: none;
            z-index: 0;
            border-radius: 24px;
            transition: background-image 0.5s ease;
        }

        @media (pointer: coarse) {
            #game-container::before {
                border-radius: 0;
            }
        }

        /* Desktop background pattern */

        @media (pointer: fine) {
            body::before {
                content: '';
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: 
                    radial-gradient(circle at 50% 50%, #2a2a4e 0%, #1a1a2e 70%);
                pointer-events: none;
                z-index: -1;
            }
        }

        #game-container {
            position: relative;
            width: 100%;
            height: 100%;
            max-width: 420px;
            max-height: 850px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            z-index: 1;
            margin: auto;
            border-radius: 24px;
            background: var(--console-color);
            box-shadow: 
                0 0 0 4px var(--console-color-dark),
                0 0 0 8px rgba(0,0,0,0.2),
                0 8px 30px rgba(0,0,0,0.4);
            transition: background 0.5s ease, box-shadow 0.5s ease;
        }

        @media (pointer: coarse) {
            #game-container {
                max-width: none;
                max-height: none;
                border-radius: 0;
                box-shadow: none;
            }
        }

        /* Game screen area - enhanced with more depth */

        #screen-container {
            position: relative;
            width: 100%;
            max-width: 360px;
            flex: 1;
            max-height: 55%;
            background: #0a0a0a;
            border: 8px solid var(--screen-border);
            border-radius: 12px;
            box-shadow: 
                inset 0 0 0 3px #1a1a1a,
                inset 0 0 20px rgba(0,0,0,0.8),
                0 6px 0 0 #3a3a3a,
                0 10px 0 0 #2a2a2a,
                0 14px 20px rgba(0,0,0,0.3);
            overflow: hidden;
            margin-top: 20px;
            z-index: 2;
            transition: border-color 0.5s ease;
        }

        @media (pointer: coarse) {
            #screen-container {
                margin-top: 100px;
                max-height: 50%;
                max-width: 400px;
            }
        }

        /* Screen bezel shine effect */

        #screen-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 30%;
            background: linear-gradient(180deg, rgba(255,255,255,0.03) 0%, transparent 100%);
            pointer-events: none;
            z-index: 10;
        }

        #gameCanvas {
            display: block;
            width: 100%;
            height: 100%;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
        }

        /* HUD below screen */

        #hud {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 360px;
            padding: 12px 10px;
            margin-top: 4px;
            z-index: 2;
        }

        .hud-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: #000000;
            padding: 12px 18px;
            border-radius: 12px;
            border: 4px solid #ffffff;
            box-shadow: 
                0 6px 0 rgba(0,0,0,0.4),
                inset 0 0 10px rgba(255,255,255,0.1);
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275), border-color 0.2s;
            min-width: 110px;
        }

        .hud-label {
            font-size: 10px;
            color: #ffffff;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            font-weight: bold;
            opacity: 0.9;
        }

        .hud-value {
            font-size: 24px;
            color: #ffffff;
            text-shadow: 
                0 0 8px rgba(255,255,255,0.3);
            letter-spacing: 3px;
        }

        .hud-item.pop {
            transform: scale(1.1);
            border-color: #ffff00;
            box-shadow: 
                0 0 10px rgba(255,255,0,0.3),
                0 6px 0 rgba(0,0,0,0.4);
        }

        @media (pointer: coarse) {
            #hud {
                max-width: 400px;
            }
            .hud-item {
                min-width: 130px;
                padding: 14px 22px;
            }
            .hud-value {
                font-size: 28px;
            }
            .hud-label {
                font-size: 11px;
            }
        }

        /* Progress bar - high performance look */

        #progress-container {
            width: 100%;
            max-width: 360px;
            height: 24px;
            background: #111111;
            border: 4px solid var(--pixel-black);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 
                0 4px 0 rgba(0,0,0,0.3),
                inset 0 2px 10px rgba(0,0,0,0.9);
            z-index: 2;
            margin-top: 12px;
            position: relative;
        }

        @media (pointer: coarse) {
            #progress-container {
                max-width: 400px;
                height: 28px;
            }
        }

        #progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, 
                #00ff00 0%, 
                #ffff00 50%, 
                #ff0000 100%);
            transition: width 0.3s ease;
            box-shadow: 
                inset 0 6px 6px rgba(255,255,255,0.5),
                inset 0 -6px 6px rgba(0,0,0,0.3);
            position: relative;
        }

        /* Progress bar sheen */

        #progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 40%;
            background: rgba(255,255,255,0.2);
            pointer-events: none;
        }

        /* Control buttons area */

        #controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 380px;
            padding: 12px 8px;
            margin-top: 6px;
            z-index: 2;
        }

        @media (pointer: coarse) {
            #controls {
                max-width: 420px;
                padding: 16px 8px;
                margin-top: -10px;
            }
        }

        /* D-Pad style buttons - enhanced with more depth */

        #dpad {
            display: flex;
            gap: 10px;
        }

        .arrow-btn {
            width: 58px;
            height: 58px;
            background: linear-gradient(180deg, #ffffff 0%, var(--console-btn-color) 40%, var(--console-btn-dark) 100%);
            border: 5px solid var(--pixel-black);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 
                0 5px 0 0 #404040,
                0 7px 0 0 #2a2a2a,
                0 10px 8px rgba(0,0,0,0.2),
                inset 0 2px 0 rgba(255,255,255,0.8),
                inset 0 -4px 0 rgba(0,0,0,0.1);
            transition: transform 0.05s, box-shadow 0.05s, background 0.5s ease;
            touch-action: manipulation;
        }

        .arrow-btn:active, .arrow-btn.pressed {
            transform: translateY(5px);
            box-shadow: 
                0 0 0 0 #404040,
                0 2px 0 0 #2a2a2a,
                0 4px 4px rgba(0,0,0,0.1),
                inset 0 3px 6px rgba(0,0,0,0.2);
        }

        .arrow-btn svg {
            width: 26px;
            height: 26px;
            fill: var(--pixel-black);
            filter: drop-shadow(1px 1px 0 rgba(255,255,255,0.5));
        }

        @media (pointer: coarse) {
            .arrow-btn {
                width: 68px;
                height: 68px;
            }
            .arrow-btn svg {
                width: 30px;
                height: 30px;
            }
        }

        /* Jump button - larger and more prominent */

        #jump-btn {
            width: 74px;
            height: 74px;
            background: linear-gradient(180deg, #ffffff 0%, var(--console-btn-color) 40%, var(--console-btn-dark) 100%);
            border: 5px solid var(--pixel-black);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 
                0 6px 0 0 #404040,
                0 8px 0 0 #2a2a2a,
                0 12px 10px rgba(0,0,0,0.25),
                inset 0 3px 0 rgba(255,255,255,0.8),
                inset 0 -5px 0 rgba(0,0,0,0.1);
            transition: transform 0.05s, box-shadow 0.05s, background 0.5s ease;
            touch-action: manipulation;
        }

        #jump-btn:active, #jump-btn.pressed {
            transform: translateY(6px);
            box-shadow: 
                0 0 0 0 #404040,
                0 2px 0 0 #2a2a2a,
                0 4px 4px rgba(0,0,0,0.1),
                inset 0 4px 8px rgba(0,0,0,0.25);
        }

        #jump-btn::after {
            content: '';
            width: 40px;
            height: 40px;
            background: linear-gradient(180deg, var(--console-color-light) 0%, var(--console-color) 50%, var(--console-color-dark) 100%);
            border: 4px solid var(--pixel-black);
            border-radius: 50%;
            box-shadow: 
                inset 0 2px 0 rgba(255,255,255,0.3),
                inset 0 -2px 0 rgba(0,0,0,0.2);
            transition: background 0.5s ease;
        }

        @media (pointer: coarse) {
            #jump-btn {
                width: 88px;
                height: 88px;
                border-width: 6px;
            }
            #jump-btn::after {
                width: 48px;
                height: 48px;
            }
        }

        /* Pause button - refined */

        #pauseBtn {
            position: absolute;
            top: 45px;
            right: 16px;
            width: 38px;
            height: 38px;
            background: linear-gradient(180deg, #ffffff 0%, var(--screen-bg) 100%);
            border: 4px solid var(--pixel-black);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 
                0 4px 0 0 #404040,
                0 6px 0 0 #2a2a2a;
            z-index: 20;
            transition: transform 0.05s, box-shadow 0.05s;
        }

        #pauseBtn:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 0 #404040, 0 2px 0 0 #2a2a2a;
        }

        #pauseBtn svg {
            width: 16px;
            height: 16px;
            fill: var(--pixel-black);
        }

        @media (pointer: coarse) {
            #pauseBtn {
                top: 120px;
                width: 42px;
                height: 42px;
            }
            #pauseBtn svg {
                width: 18px;
                height: 18px;
            }
        }

        /* Settings button (required) */

        #settingsBtn {
            position: absolute;
            top: 45px;
            right: 62px;
            width: 38px;
            height: 38px;
            background: linear-gradient(180deg, #ffffff 0%, var(--screen-bg) 100%);
            border: 4px solid var(--pixel-black);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 
                0 4px 0 0 #404040,
                0 6px 0 0 #2a2a2a;
            z-index: 20;
            transition: transform 0.05s, box-shadow 0.05s;
        }

        #settingsBtn:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 0 #404040, 0 2px 0 0 #2a2a2a;
        }

        #settingsBtn svg {
            width: 18px;
            height: 18px;
            fill: var(--pixel-black);
        }

        @media (pointer: coarse) {
            #settingsBtn {
                top: 120px;
                right: 70px;
                width: 42px;
                height: 42px;
            }
            #settingsBtn svg {
                width: 20px;
                height: 20px;
            }
        }

        /* Overlays - enhanced with animation */

        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(2px);
            -webkit-backdrop-filter: blur(2px);
            transition: opacity 0.3s ease, visibility 0.3s ease;
            pointer-events: none;
        }

        .overlay.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .overlay:not(.hidden) {
            pointer-events: auto;
        }

        .overlay-content {
            text-align: center;
            padding: 35px 30px;
            background: linear-gradient(180deg, #ffffff 0%, var(--console-btn-color) 100%);
            border: 8px solid var(--pixel-black);
            border-radius: 16px;
            box-shadow: 
                0 10px 0 0 #404040,
                0 15px 0 0 #2a2a2a,
                0 20px 30px rgba(0,0,0,0.4);
            max-width: 92%;
            width: 340px;
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transition: background 0.5s ease;
            position: relative;
            z-index: 10;
        }

        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Start Screen - Solid white background, no Game Boy visible */

        #startScreen {
            background: #ffffff !important;
            backdrop-filter: none !important;
            -webkit-backdrop-filter: none !important;
            overflow: hidden;
            border-radius: 8px;
        }

        #startScreen.hidden {
            display: none !important;
        }

        /* Falling saws container */

        .falling-saws {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 0;
        }

        .falling-saw {
            position: absolute;
            top: -100px;
            animation: sawFall linear infinite;
        }

        @keyframes sawFall {
            0% {
                transform: translateY(0) rotate(0deg);
            }
            100% {
                transform: translateY(var(--fall-distance, 800px)) rotate(720deg);
            }
        }

        @keyframes sawSpin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Start Screen Specifics */

        .title-container {
            position: relative;
            margin-bottom: 30px;
        }

        .game-title {
            font-size: 1.8rem;
            color: var(--pixel-black);
            margin-bottom: 4px;
            line-height: 1.2;
            text-shadow: 3px 3px 0 rgba(0,0,0,0.1);
            letter-spacing: -1px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(-1deg); }
            50% { transform: translateY(-10px) rotate(1deg); }
        }

        .game-subtitle {
            font-size: 0.7rem;
            color: var(--danger-red);
            font-weight: bold;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .title-saw {
            position: absolute;
            width: 40px;
            height: 40px;
            opacity: 0.15;
            z-index: -1;
            animation: sawSpin 4s linear infinite;
        }

        .saw-l { top: -20px; left: -30px; }

        .saw-r { bottom: -10px; right: -30px; }

        .instruction-box {
            background: rgba(0,0,0,0.05);
            padding: 15px;
            border-radius: 8px;
            border: 2px dashed rgba(0,0,0,0.2);
            margin-bottom: 25px;
        }

        .instructions {
            font-size: 0.5rem;
            color: var(--pixel-black);
            line-height: 1.8;
            margin-bottom: 0;
            opacity: 0.8;
            text-align: left;
        }

        .instruction-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .instruction-item:last-child { margin-bottom: 0; }

        .instruction-dot {
            width: 8px;
            height: 8px;
            background: var(--console-color);
            border-radius: 2px;
        }

        #startButton {
            width: 100%;
            padding: 18px;
            font-size: 0.9rem;
            letter-spacing: 2px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); box-shadow: 0 0 15px rgba(90, 143, 74, 0.4); }
            100% { transform: scale(1); }
        }

        .btn {
            background: linear-gradient(180deg, var(--console-color-light) 0%, var(--console-color) 50%, var(--console-color-dark) 100%);
            color: #ffffff;
            border: 5px solid var(--pixel-black);
            padding: 14px 24px;
            font-family: 'Press Start 2P', monospace;
            font-size: 0.65rem;
            cursor: pointer;
            border-radius: 6px;
            box-shadow: 
                0 5px 0 0 #3a5a2a,
                0 7px 0 0 #2a4a1a,
                inset 0 2px 0 rgba(255,255,255,0.2);
            transition: transform 0.05s, box-shadow 0.05s, background 0.5s ease;
            margin: 5px;
            text-shadow: 1px 1px 0 rgba(0,0,0,0.3);
        }

        .btn:active {
            transform: translateY(5px);
            box-shadow: 
                0 0 0 0 #3a5a2a,
                0 2px 0 0 #2a4a1a,
                inset 0 2px 4px rgba(0,0,0,0.2);
        }

        .btn-secondary {
            background: linear-gradient(180deg, #f0e8e0 0%, var(--console-btn-dark) 50%, #c8c0b8 100%);
            color: var(--pixel-black);
            box-shadow: 
                0 5px 0 0 #a8a098,
                0 7px 0 0 #888078,
                inset 0 2px 0 rgba(255,255,255,0.4);
            text-shadow: none;
            transition: background 0.5s ease;
        }

        .btn-secondary:active {
            box-shadow: 
                0 0 0 0 #a8a098,
                0 2px 0 0 #888078,
                inset 0 2px 4px rgba(0,0,0,0.15);
        }

        /* Score display - enhanced */

        .final-score {
            font-size: 2.2rem;
            color: var(--pixel-black);
            margin: 12px 0;
            text-shadow: 3px 3px 0 rgba(0,0,0,0.1);
        }

        .score-label {
            font-size: 0.45rem;
            color: var(--pixel-black);
            opacity: 0.5;
            margin-bottom: 4px;
        }

        .coins-collected {
            font-size: 0.55rem;
            color: #b8860b;
            margin-bottom: 16px;
            text-shadow: 1px 1px 0 rgba(0,0,0,0.1);
        }

        /* Settings Modal - refined */

        .settings-modal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(180deg, #ffffff 0%, var(--console-btn-color) 100%);
            border: 8px solid var(--pixel-black);
            border-radius: 12px;
            padding: 22px 20px;
            z-index: 150;
            box-shadow: 
                0 8px 0 0 #404040,
                0 12px 0 0 #2a2a2a,
                0 16px 30px rgba(0,0,0,0.4);
            min-width: 240px;
            transition: background 0.5s ease;
        }

        .settings-modal.hidden {
            display: none;
        }

        .settings-title {
            font-size: 0.7rem;
            color: var(--pixel-black);
            margin-bottom: 18px;
            text-align: center;
        }

        .settings-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 3px solid rgba(0,0,0,0.1);
        }

        .settings-row:last-of-type {
            border-bottom: none;
        }

        .settings-label {
            font-size: 0.45rem;
            color: var(--pixel-black);
        }

        .toggle {
            width: 48px;
            height: 26px;
            background: #b0a8a0;
            border: 4px solid var(--pixel-black);
            border-radius: 13px;
            position: relative;
            cursor: pointer;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
            transition: background 0.2s ease;
        }

        .toggle.active {
            background: var(--console-color);
        }

        .toggle::after {
            content: '';
            position: absolute;
            width: 14px;
            height: 14px;
            background: linear-gradient(180deg, #ffffff 0%, #e0e0e0 100%);
            border: 3px solid var(--pixel-black);
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: transform 0.2s ease;
            box-shadow: 0 2px 0 rgba(0,0,0,0.2);
        }

        .toggle.active::after {
            transform: translateX(22px);
        }

        /* Decorative screws on console frame */

        .screw {
            position: absolute;
            width: 14px;
            height: 14px;
            background: linear-gradient(135deg, #909090 0%, #707070 50%, #505050 100%);
            border-radius: 50%;
            border: 2px solid #404040;
            z-index: 3;
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.3);
        }

        .screw::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(45deg);
            width: 8px;
            height: 2px;
            background: #404040;
        }

        .screw-tl { top: 10px; left: 10px; }

        .screw-tr { top: 10px; right: 10px; }

        .screw-bl { bottom: 10px; left: 10px; }

        .screw-br { bottom: 10px; right: 10px; }

        @media (pointer: coarse) {
            .screw-tl { top: 80px; }
            .screw-tr { top: 80px; }
        }

        /* Hide controls slightly on desktop */

        @media (pointer: fine) {
            #controls {
                opacity: 0.4;
                transition: opacity 0.3s ease;
            }
            #controls:hover {
                opacity: 1;
            }
        }

        /* Mobile adjustments */

        @media (max-height: 680px) {
            #screen-container {
                max-height: 42%;
            }
            .arrow-btn {
                width: 58px;
                height: 58px;
            }
            #jump-btn {
                width: 72px;
                height: 72px;
            }
            #jump-btn::after {
                width: 40px;
                height: 40px;
            }
            .overlay-content {
                padding: 20px 18px;
            }
            .game-title {
                font-size: 0.9rem;
            }
        }
    </style>
  <script type="module" crossorigin>(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const f of r.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function a(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=a(s);fetch(s.href,r)}})();const c={PLAYER_WIDTH:30,PLAYER_HEIGHT:35,PLAYER_SPEED:4.5,JUMP_VELOCITY:-13.5,DOUBLE_JUMP_VELOCITY:-11,GRAVITY:.6,GROUND_OFFSET:30,SQUASH_AMOUNT:.3,STRETCH_AMOUNT:.2,SQUASH_RECOVERY:.15,SAW_SIZE:45,SAW_SPEED:4.5,SAW_SPAWN_INTERVAL:1600,SAW_ROTATION_SPEED:.08,SAWS_PER_ROUND:8,MAX_SAWS_ON_SCREEN:10,COIN_SIZE:14,COIN_GRAVITY:.35,COIN_BOUNCE:.6,COINS_PER_SAW:5,COIN_SPREAD:50,COIN_LIFETIME:8e3,PARTICLE_COUNT:16,PARTICLE_LIFE:600,SHAKE_JUMP:2,SHAKE_LAND:4,SHAKE_EXPLOSION:8,SHAKE_DEATH:15,SHAKE_DECAY:.85,DANGER_ZONE_SPEED:.03,DANGER_ZONE_START:-80,POPUP_DURATION:1e3,BG_THEMES:[{bg:"#f0e6f5",skyline:"#d4c6df",accent:"#6a4a8f",ground:"#5a3a7a",console:"#6a4a8f",consoleDark:"#5a3a7a",consoleLight:"#7a5a9f",btnColor:"#f0e6f5",btnDark:"#d4c6df",spikeStyle:"neon"},{bg:"#e6f0f5",skyline:"#c6d4df",accent:"#4a6a8f",ground:"#3a5a7a",console:"#4a6a8f",consoleDark:"#3a5a7a",consoleLight:"#5a7a9f",btnColor:"#e6f0f5",btnDark:"#c6d4df",spikeStyle:"industrial"},{bg:"#f5e6e6",skyline:"#dfc6c6",accent:"#8f4a4a",ground:"#7a3a3a",console:"#8f4a4a",consoleDark:"#7a3a3a",consoleLight:"#9f5a5a",btnColor:"#f5e6e6",btnDark:"#dfc6c6",spikeStyle:"crystal"},{bg:"#e6f5e6",skyline:"#c6dfc6",accent:"#4a8f5a",ground:"#3a7a4a",console:"#4a8f5a",consoleDark:"#3a7a4a",consoleLight:"#5a9f6a",btnColor:"#e6f5e6",btnDark:"#c6dfc6",spikeStyle:"organic"},{bg:"#f5efe6",skyline:"#d4cfc6",accent:"#5a8f4a",ground:"#4a7a3a",console:"#5a8f4a",consoleDark:"#4a7a3a",consoleLight:"#6aa05a",btnColor:"#f5efe6",btnDark:"#d8d0c8",spikeStyle:"classic"},{bg:"#f5f0e6",skyline:"#dfd4c6",accent:"#8f6a4a",ground:"#7a5a3a",console:"#8f6a4a",consoleDark:"#7a5a3a",consoleLight:"#9f7a5a",btnColor:"#f5f0e6",btnDark:"#dfd4c6",spikeStyle:"steampunk"}]};function w(){const e=window.__OASIZ_SETTINGS__;return{music:e?.music!==!1,fx:e?.fx!==!1,haptics:e?.haptics!==!1}}const ce=document.getElementById("gameCanvas"),t=ce.getContext("2d"),et=document.getElementById("screen-container"),se=document.getElementById("startScreen"),ue=document.getElementById("gameOverScreen"),Y=document.getElementById("pauseScreen"),ie=document.getElementById("pauseBtn"),le=document.getElementById("settingsBtn"),he=document.getElementById("settingsModal"),tt=document.getElementById("scoreDisplay"),nt=document.getElementById("roundDisplay"),Ae=document.getElementById("score-badge"),Me=document.getElementById("round-badge"),at=document.getElementById("progress-bar"),ot=document.getElementById("finalScore"),st=document.getElementById("coinsCollected"),it=document.getElementById("leftBtn"),lt=document.getElementById("rightBtn"),ct=document.getElementById("jump-btn");let p="START",u=0,S=0;window.matchMedia("(pointer: coarse)").matches;let l={x:0,y:0,vx:0,vy:0,rotation:0,isJumping:!1,canDoubleJump:!0,hasDoubleJumped:!1,facingLeft:!1,squashX:1,squashY:1,runFrame:0,runTimer:0},R=[],G=[],P=[],V=[],C=0,oe=0,M=1,K=0,m=0,v=c.DANGER_ZONE_START,re=0,fe=0,N=0,B=0,Ue="#ffffff",F=!1,z=!1,Z=!1,k=0,X=!1,j=!1,g={music:localStorage.getItem("sawDodge_music")!=="false",fx:localStorage.getItem("sawDodge_fx")!=="false",haptics:localStorage.getItem("sawDodge_haptics")!=="false"};function ee(e,n,a){return e+(n-e)*a}function rt(e){return 1-(1-e)*(1-e)}function ft(e){return 1+2.70158*Math.pow(e-1,3)+1.70158*Math.pow(e-1,2)}let i=null,T=null;const dt="https://oasiz-assets.vercel.app/audio/dodge-song.mp3";function ut(){i||(i=new AudioContext,console.log("[initAudio] Audio context initialized")),T||(T=new Audio(dt),T.loop=!0,T.volume=.4,T.preload="auto",T.addEventListener("canplaythrough",()=>{console.log("[initAudio] Background music loaded")}),T.addEventListener("error",e=>{console.log("[initAudio] Error loading background music:",e)}))}function me(){!g.music||!w().music||!T||(T.play().catch(e=>{console.log("[playBackgroundMusic] Autoplay blocked, will play on interaction:",e)}),console.log("[playBackgroundMusic] Background music started"))}function Ve(){T&&(T.pause(),console.log("[pauseBackgroundMusic] Background music paused"))}function We(){T&&(T.pause(),T.currentTime=0,console.log("[stopBackgroundMusic] Background music stopped"))}function ht(){T&&(g.music&&w().music&&p==="PLAYING"?T.paused&&T.play().catch(()=>{}):T.pause())}function mt(){if(!g.fx||!w().fx||!i)return;i.state==="suspended"&&i.resume();const e=i.createOscillator(),n=i.createGain();e.connect(n),n.connect(i.destination),e.type="square",e.frequency.setValueAtTime(220,i.currentTime),e.frequency.exponentialRampToValueAtTime(440,i.currentTime+.08),n.gain.setValueAtTime(.12,i.currentTime),n.gain.exponentialRampToValueAtTime(.01,i.currentTime+.12),e.start(i.currentTime),e.stop(i.currentTime+.12)}function pt(){if(!g.fx||!w().fx||!i)return;i.state==="suspended"&&i.resume();const e=i.createOscillator(),n=i.createGain();e.connect(n),n.connect(i.destination),e.type="triangle",e.frequency.setValueAtTime(100,i.currentTime),e.frequency.exponentialRampToValueAtTime(60,i.currentTime+.08),n.gain.setValueAtTime(.15,i.currentTime),n.gain.exponentialRampToValueAtTime(.01,i.currentTime+.1),e.start(i.currentTime),e.stop(i.currentTime+.1)}function gt(){if(!g.fx||!w().fx||!i)return;i.state==="suspended"&&i.resume();const e=i.createOscillator(),n=i.createOscillator(),a=i.createGain();e.connect(a),n.connect(a),a.connect(i.destination),e.type="sawtooth",e.frequency.setValueAtTime(200,i.currentTime),e.frequency.exponentialRampToValueAtTime(40,i.currentTime+.25),n.type="square",n.frequency.setValueAtTime(150,i.currentTime),n.frequency.exponentialRampToValueAtTime(30,i.currentTime+.3),a.gain.setValueAtTime(.2,i.currentTime),a.gain.exponentialRampToValueAtTime(.01,i.currentTime+.3),e.start(i.currentTime),n.start(i.currentTime),e.stop(i.currentTime+.3),n.stop(i.currentTime+.3)}function yt(){if(!g.fx||!w().fx||!i)return;i.state==="suspended"&&i.resume();const e=i.createOscillator(),n=i.createGain();e.connect(n),n.connect(i.destination),e.type="sine",e.frequency.setValueAtTime(880,i.currentTime),e.frequency.exponentialRampToValueAtTime(1320,i.currentTime+.06),n.gain.setValueAtTime(.1,i.currentTime),n.gain.exponentialRampToValueAtTime(.01,i.currentTime+.1),e.start(i.currentTime),e.stop(i.currentTime+.1)}function St(){if(!g.fx||!w().fx||!i)return;i.state==="suspended"&&i.resume();const e=i.createOscillator(),n=i.createGain();e.connect(n),n.connect(i.destination),e.type="sawtooth",e.frequency.setValueAtTime(400,i.currentTime),e.frequency.exponentialRampToValueAtTime(80,i.currentTime+.5),n.gain.setValueAtTime(.2,i.currentTime),n.gain.exponentialRampToValueAtTime(.01,i.currentTime+.5),e.start(i.currentTime),e.stop(i.currentTime+.5)}function Et(){if(!g.fx||!w().fx||!i)return;i.state==="suspended"&&i.resume(),[523,659,784,1047].forEach((n,a)=>{const o=i.createOscillator(),s=i.createGain();o.connect(s),s.connect(i.destination),o.type="square",o.frequency.setValueAtTime(n,i.currentTime+a*.1),s.gain.setValueAtTime(.1,i.currentTime+a*.1),s.gain.exponentialRampToValueAtTime(.01,i.currentTime+a*.1+.2),o.start(i.currentTime+a*.1),o.stop(i.currentTime+a*.1+.2)})}function W(){if(!g.fx||!w().fx||!i)return;i.state==="suspended"&&i.resume();const e=i.createOscillator(),n=i.createGain();e.connect(n),n.connect(i.destination),e.type="square",e.frequency.setValueAtTime(800,i.currentTime),n.gain.setValueAtTime(.06,i.currentTime),n.gain.exponentialRampToValueAtTime(.01,i.currentTime+.03),e.start(i.currentTime),e.stop(i.currentTime+.03)}function y(e){!g.haptics||!w().haptics||typeof window.triggerHaptic=="function"&&window.triggerHaptic(e)}function O(e){N=Math.max(N,e)}function pe(e,n=1){B=n,Ue=e}function Tt(){N>.1?(re=(Math.random()-.5)*N*2,fe=(Math.random()-.5)*N*2,N*=c.SHAKE_DECAY):(re=0,fe=0,N=0),B>0&&(B*=.85,B<.05&&(B=0))}function qe(){const e=c.BG_THEMES[(M-1)%c.BG_THEMES.length],n=document.documentElement;n.style.setProperty("--console-color",e.console),n.style.setProperty("--console-color-dark",e.consoleDark),n.style.setProperty("--console-color-light",e.consoleLight),n.style.setProperty("--console-btn-color",e.btnColor),n.style.setProperty("--console-btn-dark",e.btnDark),n.style.setProperty("--screen-bg",e.bg),console.log("[applyTheme] Theme applied for round "+M+": "+e.spikeStyle)}function At(){const e=c.BG_THEMES[(M-1)%c.BG_THEMES.length],n=t.createLinearGradient(0,0,0,S);n.addColorStop(0,e.bg),n.addColorStop(.7,e.skyline),n.addColorStop(1,e.skyline),t.fillStyle=n,t.fillRect(0,0,u,S),Mt(e),It(e),xt(e),v>0&&Pt()}function Mt(e){t.fillStyle=e.skyline,t.globalAlpha=.4,t.beginPath(),t.moveTo(0,m),[{x:0,y:m-S*.15},{x:u*.15,y:m-S*.25},{x:u*.3,y:m-S*.18},{x:u*.45,y:m-S*.3},{x:u*.6,y:m-S*.2},{x:u*.75,y:m-S*.28},{x:u*.9,y:m-S*.15},{x:u,y:m-S*.22}].forEach(a=>t.lineTo(a.x,a.y)),t.lineTo(u,m),t.closePath(),t.fill(),t.globalAlpha=1}function It(e){const n=m,a=[{x:.02,w:.06,h:.2},{x:.1,w:.05,h:.28},{x:.17,w:.08,h:.18},{x:.28,w:.04,h:.32},{x:.35,w:.07,h:.24},{x:.48,w:.05,h:.35},{x:.58,w:.08,h:.2},{x:.7,w:.05,h:.28},{x:.8,w:.06,h:.22},{x:.9,w:.07,h:.26}];t.fillStyle=e.skyline,t.globalAlpha=.5,a.forEach(o=>{const s=o.x*u,r=o.w*u,f=o.h*S*.4;t.fillRect(s,n-f,r,f),t.fillStyle=e.bg,t.globalAlpha=.3;for(let d=n-f+8;d<n-8;d+=12)for(let h=s+4;h<s+r-4;h+=8)t.fillRect(h,d,4,6);t.fillStyle=e.skyline,t.globalAlpha=.5}),t.globalAlpha=1}function xt(e){t.fillStyle=e.accent,t.fillRect(0,m,u,S-m),t.fillStyle=e.ground,t.fillRect(0,m+4,u,S-m-4),t.fillStyle=e.accent;for(let n=0;n<u;n+=8){const a=3+Math.sin(n*.5+k*.001)*2;t.fillRect(n,m-a,3,a)}}function Pt(){const e=t.createLinearGradient(0,0,0,v+40);e.addColorStop(0,"#c84040"),e.addColorStop(.8,"#c84040"),e.addColorStop(1,"rgba(200, 64, 64, 0)"),t.fillStyle=e,t.fillRect(0,0,u,v+40),t.fillStyle="#c84040";for(let n=0;n<u;n+=12){const a=n*.4+k*.003,o=Math.sin(a)*12+18,s=6+Math.sin(a*.7)*2;t.beginPath(),t.moveTo(n,v),t.lineTo(n+s,v),t.lineTo(n+s/2,v+o),t.closePath(),t.fill()}t.fillStyle="#ffcc00",t.globalAlpha=.3;for(let n=0;n<u;n+=20){const a=k*.05%20;t.fillRect(n-a,v-4,10,4)}t.globalAlpha=1}function Ie(){const e=l.x,n=l.y,a=c.PLAYER_WIDTH,o=c.PLAYER_HEIGHT;t.save();const s=e+a/2,r=n+o/2;t.translate(s,r),l.facingLeft&&t.scale(-1,1),t.rotate(l.rotation),t.scale(l.squashX,l.squashY),t.translate(-a/2,-o/2);const f="#40a0ff",d="#80c0ff",h="#2060c0",E="#b0e0ff",L=Math.sin(k*.008)*1.5,b=Math.sin(l.runTimer*.02);t.fillStyle=f,t.beginPath(),t.roundRect(0,2+L,a,o-6,12),t.fill(),t.fillStyle=d,t.beginPath(),t.roundRect(4,4+L,a-8,8,6),t.fill(),t.fillStyle=h;const A=o-4,x=6,D=6;if(l.isJumping)t.fillRect(4,A-2,x,D),t.fillRect(a-10,A-2,x,D);else if(Math.abs(l.vx)>.5){const U=b*5;t.fillRect(6+U,A+Math.abs(U)*.2,x,D),t.fillRect(a-12-U,A+Math.abs(U)*.2,x,D)}else t.fillRect(6,A,x,D),t.fillRect(a-12,A,x,D);const I=12+L*.5,H=7;t.fillStyle="#ffffff",t.beginPath(),t.arc(8,I,H,0,Math.PI*2),t.fill(),t.beginPath(),t.arc(a-8,I,H,0,Math.PI*2),t.fill(),t.fillStyle="#1a1a2e";const _=l.vx*.4;t.beginPath(),t.arc(8+_,I+1,3.5,0,Math.PI*2),t.fill(),t.beginPath(),t.arc(a-8+_,I+1,3.5,0,Math.PI*2),t.fill(),t.fillStyle="#ffffff",t.beginPath(),t.arc(6+_,I-1,1.5,0,Math.PI*2),t.fill(),t.beginPath(),t.arc(a-10+_,I-1,1.5,0,Math.PI*2),t.fill(),t.fillStyle="#ff90a0",t.globalAlpha=.4,t.beginPath(),t.ellipse(4,I+6,4,2,0,0,Math.PI*2),t.fill(),t.beginPath(),t.ellipse(a-4,I+6,4,2,0,0,Math.PI*2),t.fill(),t.globalAlpha=1,t.strokeStyle=h,t.lineWidth=2,t.lineCap="round",l.hasDoubleJumped&&l.rotation!==0?(t.fillStyle=h,t.beginPath(),t.arc(a/2,I+8,3,0,Math.PI*2),t.fill()):(t.beginPath(),t.arc(a/2,I+6,4,.2,Math.PI-.2),t.stroke()),l.hasDoubleJumped&&l.isJumping&&(t.globalAlpha=.3+Math.sin(k*.02)*.2,t.fillStyle=E,t.beginPath(),t.arc(a/2,o/2,a,0,Math.PI*2),t.fill(),t.globalAlpha=1),t.restore()}function xe(e){const n=e.x,a=e.y,o=c.SAW_SIZE/2*e.scale;if(t.save(),t.translate(n,a),t.rotate(e.rotation),e.glowIntensity>0){let h="rgba(255, 100, 100, ";e.style==="crystal"&&(h="rgba(100, 200, 255, "),e.style==="neon"&&(h="rgba(255, 0, 255, ");const E=t.createRadialGradient(0,0,0,0,0,o*1.5);E.addColorStop(0,h+e.glowIntensity*.5+")"),E.addColorStop(1,h+"0)"),t.fillStyle=E,t.beginPath(),t.arc(0,0,o*1.5,0,Math.PI*2),t.fill()}let s="#404040",r="#606060",f="#505050",d=10;if(e.exploding)s="#ff4040",r="#ffff40",f="#ffffff";else switch(e.style){case"industrial":s="#2a2a2a",r="#808080",f="#3a3a3a",d=8;break;case"crystal":s="#40a0ff",r="#a0d0ff",f="#ffffff",d=6;break;case"organic":s="#4a7a3a",r="#6aa05a",f="#2a4a1a",d=12;break;case"neon":s="#ff00ff",r="#ffffff",f="#000000",d=10;break;case"steampunk":s="#8b4513",r="#daa520",f="#cd7f32",d=14;break}t.fillStyle=s,t.beginPath();for(let h=0;h<d;h++){const E=h/d*Math.PI*2,L=(h+.5)/d*Math.PI*2,b=o,A=o*(e.style==="crystal"?.5:.7);h===0&&t.moveTo(Math.cos(E)*b,Math.sin(E)*b),t.lineTo(Math.cos(L)*A,Math.sin(L)*A);const x=(h+1)/d*Math.PI*2;t.lineTo(Math.cos(x)*b,Math.sin(x)*b)}if(t.closePath(),t.fill(),e.style==="steampunk"&&!e.exploding){t.strokeStyle="#daa520",t.lineWidth=2,t.stroke(),t.fillStyle="#cd7f32";for(let h=0;h<4;h++){const E=h/4*Math.PI*2;t.beginPath(),t.arc(Math.cos(E)*o*.4,Math.sin(E)*o*.4,3,0,Math.PI*2),t.fill()}}else e.style==="neon"&&!e.exploding&&(t.strokeStyle="#ffffff",t.lineWidth=3,t.stroke(),t.shadowBlur=10,t.shadowColor="#ff00ff");t.fillStyle=r,t.beginPath(),t.arc(0,0,o*.35,0,Math.PI*2),t.fill(),t.fillStyle=f,t.beginPath(),t.arc(0,0,o*.15,0,Math.PI*2),t.fill(),t.restore()}function Pe(e){if(e.collected)return;const n=e.x,a=e.y+Math.sin(e.bobOffset+k*.005)*3,o=c.COIN_SIZE/2,s=c.COIN_LIFETIME*.7;let r=1;if(e.lifetime<s&&(r=e.lifetime/s),t.save(),t.globalAlpha=r,t.translate(n,a),e.sparkle>0){t.fillStyle="#ffffff",t.globalAlpha=e.sparkle*r;for(let d=0;d<4;d++){const h=d/4*Math.PI*2+k*.01,E=o*1.5;t.fillRect(Math.cos(h)*E-2,Math.sin(h)*E-2,4,4)}t.globalAlpha=r}const f=t.createRadialGradient(-o*.3,-o*.3,0,0,0,o);f.addColorStop(0,"#fff700"),f.addColorStop(.5,"#ffd700"),f.addColorStop(1,"#b8860b"),t.fillStyle=f,t.beginPath(),t.arc(0,0,o,0,Math.PI*2),t.fill(),t.strokeStyle="#8b6914",t.lineWidth=2,t.stroke(),t.fillStyle="#b8860b",t.fillRect(-2,-o*.5,4,o),t.fillRect(-o*.5,-2,o,4),t.restore()}function Lt(e){const n=e.life/e.maxLife;if(t.save(),t.globalAlpha=n,t.translate(e.x,e.y),t.rotate(e.rotation),e.type==="star"){t.fillStyle=e.color;const a=e.size*n;t.beginPath();for(let o=0;o<5;o++){const s=o/5*Math.PI*2-Math.PI/2,r=s+Math.PI/5;t.lineTo(Math.cos(s)*a,Math.sin(s)*a),t.lineTo(Math.cos(r)*a*.4,Math.sin(r)*a*.4)}t.closePath(),t.fill()}else{const a=e.size*n;t.fillStyle=e.color,t.fillRect(-a/2,-a/2,a,a)}t.restore()}function Le(){for(const e of P)Lt(e)}function _e(){for(const e of V){const n=1-e.life/e.maxLife,a=1-rt(n),o=e.y-n*30,s=1+ft(Math.min(n*3,1))*.3;t.save(),t.globalAlpha=a,t.translate(e.x,o),t.scale(s,s),t.font="bold 14px 'Press Start 2P', monospace",t.textAlign="center",t.textBaseline="middle",t.fillStyle="#000000",t.fillText(e.value,1,1),t.fillStyle=e.color,t.fillText(e.value,0,0),t.restore()}}function ve(){B>0&&(t.fillStyle=Ue,t.globalAlpha=B*.4,t.fillRect(0,0,u,S),t.globalAlpha=1)}let te=-1,ne=-1;function Re(){C!==te&&(tt.textContent=C.toString(),te!==-1&&(Ae.classList.add("pop"),setTimeout(()=>Ae.classList.remove("pop"),120)),te=C),M!==ne&&(nt.textContent=M.toString(),ne!==-1&&(Me.classList.add("pop"),setTimeout(()=>Me.classList.remove("pop"),200)),ne=M);const e=K/c.SAWS_PER_ROUND*100;at.style.width=e+"%"}function ge(e,n,a,o){V.push({x:e,y:n,value:a,life:c.POPUP_DURATION,maxLife:c.POPUP_DURATION,color:o})}function _t(e,n){const a=["#ff6060","#ff8040","#ffff40","#ffffff"];for(let o=0;o<c.PARTICLE_COUNT;o++){const s=o/c.PARTICLE_COUNT*Math.PI*2+Math.random()*.3,r=4+Math.random()*6,f=Math.random()>.6;P.push({x:e,y:n,vx:Math.cos(s)*r,vy:Math.sin(s)*r-2,life:c.PARTICLE_LIFE+Math.random()*200,maxLife:c.PARTICLE_LIFE+Math.random()*200,size:f?8+Math.random()*6:5+Math.random()*5,color:a[Math.floor(Math.random()*a.length)],type:f?"star":"explosion",rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*.2})}}function vt(e,n){const a=c.BG_THEMES[(M-1)%c.BG_THEMES.length];for(let o=0;o<6;o++){const s=Math.PI+(Math.random()-.5)*Math.PI*.8,r=1+Math.random()*2;P.push({x:e+(Math.random()-.5)*c.PLAYER_WIDTH,y:n,vx:Math.cos(s)*r,vy:Math.sin(s)*r-1,life:300+Math.random()*200,maxLife:400,size:4+Math.random()*4,color:a.accent,type:"dust",rotation:0,rotationSpeed:0})}}function Rt(e,n){for(let a=0;a<8;a++){const o=a/8*Math.PI*2,s=2+Math.random()*3;P.push({x:e,y:n,vx:Math.cos(o)*s,vy:Math.sin(o)*s,life:300,maxLife:300,size:4,color:"#ffd700",type:"star",rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*.3})}}function wt(e){const n=l.isJumping,a=(F?-1:0)+(z?1:0);l.vx=ee(l.vx,a*c.PLAYER_SPEED,.3),l.vx<-.1?l.facingLeft=!0:l.vx>.1&&(l.facingLeft=!1),l.x+=l.vx,l.x<0&&(l.x=0),l.x+c.PLAYER_WIDTH>u&&(l.x=u-c.PLAYER_WIDTH),Math.abs(l.vx)>.5&&!l.isJumping&&(l.runTimer+=e,l.runTimer>100&&(l.runFrame=(l.runFrame+1)%4,l.runTimer=0)),l.hasDoubleJumped&&l.rotation<Math.PI*2&&(l.rotation+=.3,l.rotation>Math.PI*2&&(l.rotation=Math.PI*2)),l.vy+=c.GRAVITY,!Z&&l.vy<-2&&(l.vy*=.65),l.y+=l.vy,l.y+c.PLAYER_HEIGHT>=m&&(l.y=m-c.PLAYER_HEIGHT,l.rotation=0,n&&l.vy>2&&(l.squashX=1+c.SQUASH_AMOUNT,l.squashY=1-c.SQUASH_AMOUNT,O(c.SHAKE_LAND),vt(l.x+c.PLAYER_WIDTH/2,m),pt(),y("light"),Ht()),l.vy=0,l.isJumping=!1,l.canDoubleJump=!0,l.hasDoubleJumped=!1),l.squashX=ee(l.squashX,1,c.SQUASH_RECOVERY),l.squashY=ee(l.squashY,1,c.SQUASH_RECOVERY),v>l.y+5&&Je()}function we(){p==="PLAYING"&&(l.isJumping?l.canDoubleJump&&!l.hasDoubleJumped&&(l.vy=c.DOUBLE_JUMP_VELOCITY,l.hasDoubleJumped=!0,l.canDoubleJump=!1,l.rotation=0,l.squashX=1-c.STRETCH_AMOUNT*.7,l.squashY=1+c.STRETCH_AMOUNT*.7,Dt(l.x+c.PLAYER_WIDTH/2,l.y+c.PLAYER_HEIGHT/2),O(c.SHAKE_JUMP*1.3),Ct(),y("medium"),console.log("[jump] Player double jumped and flipped!")):(l.vy=c.JUMP_VELOCITY,l.isJumping=!0,l.canDoubleJump=!0,l.hasDoubleJumped=!1,l.squashX=1-c.STRETCH_AMOUNT,l.squashY=1+c.STRETCH_AMOUNT,bt(l.x+c.PLAYER_WIDTH/2,m),O(c.SHAKE_JUMP),mt(),y("light"),console.log("[jump] Player jumped")))}function bt(e,n){const a=c.BG_THEMES[(M-1)%c.BG_THEMES.length];for(let o=0;o<10;o++){const s=Math.PI+(Math.random()-.5)*Math.PI*.7,r=2+Math.random()*3;P.push({x:e+(Math.random()-.5)*c.PLAYER_WIDTH,y:n-2,vx:Math.cos(s)*r,vy:Math.sin(s)*r-2,life:400,maxLife:400,size:6+Math.random()*5,color:a.accent,type:"dust",rotation:0,rotationSpeed:0})}}function Dt(e,n){const a=["#60a8ff","#80c8ff","#ffffff","#4080e0"];for(let o=0;o<16;o++){const s=o/16*Math.PI*2,r=4+Math.random()*2.5;P.push({x:e+Math.cos(s)*12,y:n+Math.sin(s)*10,vx:Math.cos(s)*r,vy:Math.sin(s)*r,life:450,maxLife:450,size:6+Math.random()*5,color:a[o%a.length],type:"star",rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*.35})}for(let o=0;o<8;o++)P.push({x:e+(Math.random()-.5)*24,y:n+10,vx:(Math.random()-.5)*2,vy:4+Math.random()*4,life:350,maxLife:350,size:7+Math.random()*5,color:"#80c8ff",type:"dust",rotation:0,rotationSpeed:0});for(let o=0;o<6;o++){const s=o/6*Math.PI*2+Math.PI/6;P.push({x:e,y:n,vx:Math.cos(s)*6,vy:Math.sin(s)*6-2,life:300,maxLife:300,size:4,color:"#ffffff",type:"star",rotation:Math.random()*Math.PI*2,rotationSpeed:.4})}}function Ct(){if(!g.fx||!w().fx||!i)return;i.state==="suspended"&&i.resume();const e=i.createOscillator(),n=i.createOscillator(),a=i.createGain();e.connect(a),n.connect(a),a.connect(i.destination),e.type="sine",e.frequency.setValueAtTime(400,i.currentTime),e.frequency.exponentialRampToValueAtTime(800,i.currentTime+.12),n.type="triangle",n.frequency.setValueAtTime(600,i.currentTime),n.frequency.exponentialRampToValueAtTime(1200,i.currentTime+.12),a.gain.setValueAtTime(.1,i.currentTime),a.gain.exponentialRampToValueAtTime(.01,i.currentTime+.15),e.start(i.currentTime),n.start(i.currentTime),e.stop(i.currentTime+.15),n.stop(i.currentTime+.15)}function Ot(){const e=Math.random()*(u-c.SAW_SIZE*2)+c.SAW_SIZE,n=c.SAW_SPEED+(M-1)*.15,a=c.BG_THEMES[(M-1)%c.BG_THEMES.length],o=(Math.random()*.6+.2)*Math.PI,s=Math.cos(o)*n*(Math.random()>.5?1:-1),r=Math.abs(Math.sin(o)*n);R.push({x:e,y:-45,vx:s,vy:r,speed:n,rotation:Math.random()*Math.PI*2,jumpedOver:!1,passed:!1,hasHitGround:!1,exploding:!1,explodeTimer:0,scale:1,glowIntensity:0,style:a.spikeStyle}),console.log("[spawnSaw] Spawned saw at x="+e.toFixed(0)+" with style "+a.spikeStyle)}function kt(e){const n=c.SAW_SIZE/2;for(let a=R.length-1;a>=0;a--){const o=R[a];if(o.exploding){if(o.explodeTimer-=e,o.rotation+=c.SAW_ROTATION_SPEED*4,o.scale=ee(o.scale,0,.1),o.glowIntensity=o.explodeTimer/400,o.explodeTimer<=0){R.splice(a,1);continue}}else{if(o.x+=o.vx,o.y+=o.vy,o.rotation+=c.SAW_ROTATION_SPEED*(Math.abs(o.vx)+Math.abs(o.vy))*.3,o.x-n<=0&&(o.x=n,o.vx=Math.abs(o.vx),O(2),y("light")),o.x+n>=u&&(o.x=u-n,o.vx=-Math.abs(o.vx),O(2),y("light")),o.y-n<=0&&!o.hasHitGround&&(o.y=n,o.vy=Math.abs(o.vy),O(2),y("light")),o.y+n<-50&&o.hasHitGround){R.splice(a,1);continue}if(o.y+n>=m&&(o.y=m-n,o.vy=-Math.abs(o.vy),o.hasHitGround=!0,O(3),y("light")),!o.jumpedOver&&!o.passed&&l.isJumping){const s=l.y+c.PLAYER_HEIGHT,r=l.x,f=l.x+c.PLAYER_WIDTH,d=o.y-n,h=o.x-n,E=o.x+n,L=f>h&&r<E,b=s<d+10;L&&b&&(o.jumpedOver=!0,o.glowIntensity=.5,console.log("[updateSaws] Player jumped over saw!"))}if(!o.passed&&Nt(o)){Je();return}}}}function Ht(){for(let e=R.length-1;e>=0;e--){const n=R[e];n.jumpedOver&&!n.passed&&!n.exploding&&(n.passed=!0,C++,K++,n.exploding=!0,n.explodeTimer=400,n.glowIntensity=1,O(c.SHAKE_EXPLOSION),pe("#ff8040",.8),gt(),y("medium"),_t(n.x,n.y),Gt(n.x,n.y),ge(n.x,n.y-20,"+1","#ffffff"),console.log("[onPlayerLand] Saw dodged on landing! Score: "+C),K>=c.SAWS_PER_ROUND&&Vt())}}function Nt(e){const n=l.x+c.PLAYER_WIDTH/2,a=l.y+c.PLAYER_HEIGHT/2,o=n-e.x,s=a-e.y,r=Math.sqrt(o*o+s*s),f=c.SAW_SIZE/2*.7+Math.min(c.PLAYER_WIDTH,c.PLAYER_HEIGHT)/3;return r<f}function Gt(e,n){for(let a=0;a<c.COINS_PER_SAW;a++){const o=(a/c.COINS_PER_SAW-.5)*Math.PI*.8-Math.PI/2,s=Math.cos(o)*c.COIN_SPREAD*(.6+Math.random()*.4),r=Math.sin(o)*c.COIN_SPREAD*.5;G.push({x:e+s,y:n+r,vy:-6-Math.random()*4,collected:!1,rotation:Math.random()*Math.PI*2,onGround:!1,lifetime:c.COIN_LIFETIME,bobOffset:Math.random()*Math.PI*2,sparkle:1})}}function Bt(e){for(let n=G.length-1;n>=0;n--){const a=G[n];if(a.collected){G.splice(n,1);continue}if(a.sparkle=Math.max(0,a.sparkle-e*.002),a.lifetime-=e,a.lifetime<=0){G.splice(n,1);continue}a.onGround||(a.vy+=c.COIN_GRAVITY,a.y+=a.vy,a.y+c.COIN_SIZE/2>=m&&(a.y=m-c.COIN_SIZE/2,a.vy=-a.vy*c.COIN_BOUNCE,Math.abs(a.vy)<1.5&&(a.onGround=!0,a.vy=0))),Yt(a)&&(a.collected=!0,oe++,yt(),y("light"),Rt(a.x,a.y),ge(a.x,a.y,"+1","#ffd700"))}}function Yt(e){const n=l.x+c.PLAYER_WIDTH/2,a=l.y+c.PLAYER_HEIGHT/2,o=n-e.x,s=a-e.y;return Math.sqrt(o*o+s*s)<c.COIN_SIZE+c.PLAYER_WIDTH/2}function be(e){for(let n=P.length-1;n>=0;n--){const a=P[n];a.x+=a.vx,a.y+=a.vy,a.vy+=.15,a.vx*=.98,a.rotation+=a.rotationSpeed,a.life-=e,a.life<=0&&P.splice(n,1)}}function De(e){for(let n=V.length-1;n>=0;n--)V[n].life-=e,V[n].life<=0&&V.splice(n,1)}function Ut(){v+=c.DANGER_ZONE_SPEED}function Vt(){M++,K=0,v=c.DANGER_ZONE_START,qe(),pe("#ffffff",1),O(10),Et(),y("success"),ge(u/2,S/3,"ROUND "+M+"!","#ffffff"),console.log("[nextRound] Starting round "+M);const e=c.BG_THEMES[(M-1)%c.BG_THEMES.length];for(let n=0;n<30;n++)P.push({x:Math.random()*u,y:S+20,vx:(Math.random()-.5)*4,vy:-8-Math.random()*8,life:1200,maxLife:1200,size:8+Math.random()*6,color:n%2===0?e.accent:"#ffffff",type:"star",rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*.1})}function Wt(){console.log("[resetGame] Resetting game state"),C=0,oe=0,M=1,K=0,v=c.DANGER_ZONE_START,k=0,qe(),R=[],G=[],P=[],V=[],N=0,B=0,te=-1,ne=-1,l.x=u/2-c.PLAYER_WIDTH/2,l.y=m-c.PLAYER_HEIGHT,l.vx=0,l.vy=0,l.rotation=0,l.isJumping=!1,l.canDoubleJump=!0,l.hasDoubleJumped=!1,l.facingLeft=!1,l.squashX=1,l.squashY=1,l.runFrame=0}function Je(){p="GAME_OVER",console.log("[gameOver] Final score: "+C+", Coins: "+oe),typeof window.submitScore=="function"&&(window.submitScore(C),console.log("[gameOver] Score submitted: "+C)),O(c.SHAKE_DEATH),pe("#ff0000",1);for(let e=0;e<25;e++){const n=e/25*Math.PI*2,a=3+Math.random()*5;P.push({x:l.x+c.PLAYER_WIDTH/2,y:l.y+c.PLAYER_HEIGHT/2,vx:Math.cos(n)*a,vy:Math.sin(n)*a-3,life:800,maxLife:800,size:6+Math.random()*6,color:e%3===0?"#40a0ff":e%3===1?"#80c0ff":"#ffffff",type:"explosion",rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*.2})}St(),y("error"),We(),ot.textContent=C.toString(),st.textContent=oe+" COINS",se.classList.add("hidden"),Y.classList.add("hidden"),ue.classList.remove("hidden"),ie.classList.add("hidden"),le.classList.add("hidden")}function $(){console.log("[startGame] Starting game"),p="PLAYING",Ft(),ut(),Wt(),se.classList.add("hidden"),ue.classList.add("hidden"),Y.classList.add("hidden"),ie.classList.remove("hidden"),le.classList.remove("hidden"),W(),y("light"),me()}function Ce(){p==="PLAYING"&&(console.log("[pauseGame] Game paused"),p="PAUSED",Y.classList.remove("hidden"),y("light"),Ve())}function Oe(){p==="PAUSED"&&(console.log("[resumeGame] Game resumed"),p="PLAYING",Y.classList.add("hidden"),y("light"),me())}function de(){console.log("[showStartScreen] Showing start screen"),p="START",se.classList.remove("hidden"),ue.classList.add("hidden"),Y.classList.add("hidden"),ie.classList.add("hidden"),le.classList.add("hidden"),ze(),We()}function qt(){console.log("[openSettings] Opening settings"),X=p==="PLAYING",j=p==="PAUSED",p="PAUSED",Y.classList.add("hidden"),he.classList.remove("hidden"),W(),Ve(),y("light")}function ke(){console.log("[closeSettings] Closing settings"),he.classList.add("hidden"),W(),y("light"),X?(X=!1,j=!1,p="PLAYING",me()):j?(X=!1,j=!1,p="PAUSED",Y.classList.remove("hidden")):(X=!1,j=!1)}function Jt(){window.addEventListener("keydown",s=>{if((s.key==="ArrowLeft"||s.key==="a"||s.key==="A")&&(F=!0,p==="PLAYING"&&y("light")),(s.key==="ArrowRight"||s.key==="d"||s.key==="D")&&(z=!0,p==="PLAYING"&&y("light")),(s.key===" "||s.key==="ArrowUp"||s.key==="w"||s.key==="W")&&(s.preventDefault(),Z=!0,p==="PLAYING"?we():p==="START"&&$()),s.key==="Escape"){if(!he.classList.contains("hidden")){ke();return}p==="PLAYING"?Ce():p==="PAUSED"&&Oe()}}),window.addEventListener("keyup",s=>{(s.key==="ArrowLeft"||s.key==="a"||s.key==="A")&&(F=!1),(s.key==="ArrowRight"||s.key==="d"||s.key==="D")&&(z=!1),(s.key===" "||s.key==="ArrowUp"||s.key==="w"||s.key==="W")&&(Z=!1)});function e(s,r,f){s.addEventListener("touchstart",d=>{d.preventDefault(),r(),s.classList.add("pressed")}),s.addEventListener("touchend",d=>{d.preventDefault(),f(),s.classList.remove("pressed")}),s.addEventListener("touchcancel",d=>{d.preventDefault(),f(),s.classList.remove("pressed")}),s.addEventListener("mousedown",d=>{d.preventDefault(),r(),s.classList.add("pressed")}),s.addEventListener("mouseup",d=>{d.preventDefault(),f(),s.classList.remove("pressed")}),s.addEventListener("mouseleave",()=>{f(),s.classList.remove("pressed")})}e(it,()=>{F=!0,p==="PLAYING"&&y("light")},()=>{F=!1}),e(lt,()=>{z=!0,p==="PLAYING"&&y("light")},()=>{z=!1}),e(ct,()=>{Z=!0,p==="PLAYING"&&we()},()=>{Z=!1}),document.getElementById("startButton").addEventListener("click",$),ie.addEventListener("click",Ce),le.addEventListener("click",qt),document.getElementById("resumeButton").addEventListener("click",Oe),document.getElementById("pauseRestartBtn").addEventListener("click",()=>{Y.classList.add("hidden"),$()}),document.getElementById("pauseMenuBtn").addEventListener("click",de),document.getElementById("restartButton").addEventListener("click",$),document.getElementById("menuButton").addEventListener("click",de);const n=document.getElementById("musicToggle"),a=document.getElementById("fxToggle"),o=document.getElementById("hapticToggle");n.classList.toggle("active",g.music),a.classList.toggle("active",g.fx),o.classList.toggle("active",g.haptics),n.addEventListener("click",()=>{g.music=!g.music,n.classList.toggle("active",g.music),localStorage.setItem("sawDodge_music",g.music.toString()),ht(),W(),y("light")}),a.addEventListener("click",()=>{g.fx=!g.fx,a.classList.toggle("active",g.fx),localStorage.setItem("sawDodge_fx",g.fx.toString()),g.fx&&W(),y("light")}),o.addEventListener("click",()=>{g.haptics=!g.haptics,o.classList.toggle("active",g.haptics),localStorage.setItem("sawDodge_haptics",g.haptics.toString()),W(),y("light")}),document.getElementById("settingsClose").addEventListener("click",ke)}function He(){const e=et.getBoundingClientRect();u=e.width,S=e.height,ce.width=u,ce.height=S,t.imageSmoothingEnabled=!1,m=S-c.GROUND_OFFSET,l.y>m-c.PLAYER_HEIGHT&&(l.y=m-c.PLAYER_HEIGHT),console.log("[resizeCanvas] Canvas resized to: "+u+" x "+S)}let Ne=0,Ge=0,q=0;const J=1e3/60;function Fe(e){const n=Math.min(e-Ne,100);if(Ne=e,k=e,q+=n,Tt(),t.save(),t.translate(re,fe),t.clearRect(-20,-20,u+40,S+40),At(),p==="PLAYING"){const a=R.filter(r=>!r.exploding).length,o=c.MAX_SAWS_ON_SCREEN+Math.floor((M-1)*.5),s=c.SAW_SPAWN_INTERVAL/(1+(M-1)*.1);for(e-Ge>s&&a<o&&(Ot(),Ge=e);q>=J;)wt(J),kt(J),Bt(J),Ut(),q-=J;be(n),De(n);for(const r of G)Pe(r);for(const r of R)xe(r);Ie(),Le(),_e(),ve(),Re()}else if(p==="START")t.fillStyle="#ffffff",t.fillRect(0,0,u,S),q=0;else if(p==="PAUSED"||p==="GAME_OVER"){for(const a of G)Pe(a);for(const a of R)xe(a);p==="PAUSED"&&Ie(),Le(),be(n),_e(),De(n),ve(),Re(),q=0}t.restore(),requestAnimationFrame(Fe)}const ye=document.getElementById("fallingSaws");let ae=null;const Be=[{main:"#c84040",teeth:"#e06060",core:"#802020"},{main:"#4080c8",teeth:"#60a0e0",core:"#205080"},{main:"#40c840",teeth:"#60e060",core:"#208020"},{main:"#c8a040",teeth:"#e0c060",core:"#806020"},{main:"#8040c8",teeth:"#a060e0",core:"#502080"},{main:"#c84080",teeth:"#e060a0",core:"#802050"},{main:"#40c8c8",teeth:"#60e0e0",core:"#208080"},{main:"#c86040",teeth:"#e08060",core:"#804020"}];function Ye(){const e=document.createElement("div");e.className="falling-saw";const n=se.getBoundingClientRect(),a=n.width,o=n.height,s=30+Math.random()*45,r=Math.random()*(a-s),f=3+Math.random()*3,d=Math.random()*-f,h=.25+Math.random()*.45,E=6+Math.floor(Math.random()*6),L=Be[Math.floor(Math.random()*Be.length)],b=o+s+100;e.style.cssText="left: "+r+"px; width: "+s+"px; height: "+s+"px; animation-duration: "+f+"s; animation-delay: "+d+"s; opacity: "+h+"; --fall-distance: "+b+"px;";const A=document.createElementNS("http://www.w3.org/2000/svg","svg");A.setAttribute("viewBox","0 0 100 100"),A.setAttribute("width","100%"),A.setAttribute("height","100%");let x="";for(let _=0;_<E;_++){const U=_/E*Math.PI*2,Se=(_+.5)/E*Math.PI*2,Ee=(_+1)/E*Math.PI*2,Q=45,Te=30,Ze=50+Math.cos(U)*Q,Xe=50+Math.sin(U)*Q,je=50+Math.cos(Se)*Te,Ke=50+Math.sin(Se)*Te,Qe=50+Math.cos(Ee)*Q,$e=50+Math.sin(Ee)*Q;_===0&&(x+="M "+Ze+" "+Xe+" "),x+="L "+je+" "+Ke+" L "+Qe+" "+$e+" "}x+="Z";const D=document.createElementNS("http://www.w3.org/2000/svg","path");D.setAttribute("d",x),D.setAttribute("fill",L.main);const I=document.createElementNS("http://www.w3.org/2000/svg","circle");I.setAttribute("cx","50"),I.setAttribute("cy","50"),I.setAttribute("r","15"),I.setAttribute("fill",L.teeth);const H=document.createElementNS("http://www.w3.org/2000/svg","circle");H.setAttribute("cx","50"),H.setAttribute("cy","50"),H.setAttribute("r","6"),H.setAttribute("fill",L.core),A.appendChild(D),A.appendChild(I),A.appendChild(H),e.appendChild(A),ye.appendChild(e),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},(f-d)*1e3+100)}function ze(){console.log("[startFallingSaws] Starting falling saws animation"),ye.innerHTML="";for(let e=0;e<12;e++)Ye();ae=window.setInterval(()=>{p==="START"&&Ye()},400)}function Ft(){console.log("[stopFallingSaws] Stopping falling saws animation"),ae!==null&&(clearInterval(ae),ae=null),ye.innerHTML=""}function zt(){console.log("[init] Initializing Saw Dodge"),He(),window.addEventListener("resize",He),Jt(),l.x=u/2-c.PLAYER_WIDTH/2,l.y=m-c.PLAYER_HEIGHT,requestAnimationFrame(Fe),de(),ze(),console.log("[init] Game initialized")}zt();</script>
</head>
<body>
    <div id="game-container">
        <!-- Decorative screws -->
        <div class="screw screw-tl"></div>
        <div class="screw screw-tr"></div>
        <div class="screw screw-bl"></div>
        <div class="screw screw-br"></div>
        <!-- Pause Button -->
        <button id="pauseBtn" class="hidden">
            <svg viewBox="0 0 24 24">
                <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
            </svg>
        </button>
        <!-- Settings Button (hidden on start screen) -->
        <button id="settingsBtn" class="hidden" aria-label="Settings">
            <svg viewBox="0 0 24 24">
                <path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
            </svg>
        </button>

        <!-- Game Screen -->
        <div id="screen-container">
            <canvas id="gameCanvas"></canvas>
        </div>

        <!-- HUD -->
        <div id="hud">
            <div class="hud-item" id="score-badge">
                <span class="hud-label">SCORE</span>
                <span class="hud-value" id="scoreDisplay">0</span>
            </div>
            <div class="hud-item" id="round-badge">
                <span class="hud-label">ROUND</span>
                <span class="hud-value" id="roundDisplay">1</span>
            </div>
        </div>

        <!-- Progress Bar -->
        <div id="progress-container">
            <div id="progress-bar"></div>
        </div>

        <!-- Controls -->
        <div id="controls">
            <div id="dpad">
                <button class="arrow-btn" id="leftBtn">
                    <svg viewBox="0 0 24 24">
                        <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                    </svg>
                </button>
                <button class="arrow-btn" id="rightBtn">
                    <svg viewBox="0 0 24 24">
                        <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                    </svg>
                </button>
            </div>
            <button id="jump-btn"></button>
        </div>

        <!-- Start Screen - Full viewport with falling saws -->
        <div id="startScreen" class="overlay">
            <div class="falling-saws" id="fallingSaws"></div>
            <div class="overlay-content">
                <div class="title-container">
                    <svg class="title-saw saw-l" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="40" fill="none" stroke="currentColor" stroke-width="8" stroke-dasharray="10 10"/>
                        <circle cx="50" cy="50" r="10" fill="currentColor"/>
                    </svg>
                    <svg class="title-saw saw-r" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="40" fill="none" stroke="currentColor" stroke-width="8" stroke-dasharray="10 10"/>
                        <circle cx="50" cy="50" r="10" fill="currentColor"/>
                    </svg>
                    <h1 class="game-title">SAW DODGE</h1>
                    <p class="game-subtitle">Elite Handheld Edition</p>
                </div>

                <div class="instruction-box">
                    <div class="instruction-item">
                        <div class="instruction-dot"></div>
                        <span class="instructions">DODGE FALLING SPIKES</span>
                    </div>
                    <div class="instruction-item">
                        <div class="instruction-dot"></div>
                        <span class="instructions">JUMP FOR POINTS (+1)</span>
                    </div>
                    <div class="instruction-item">
                        <div class="instruction-dot"></div>
                        <span class="instructions">COLLECT GOLDEN COINS</span>
                    </div>
                    <div class="instruction-item">
                        <div class="instruction-dot"></div>
                        <span class="instructions">DOUBLE JUMP TO FLIP!</span>
                    </div>
                </div>

                <button class="btn" id="startButton">PRESS START</button>
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="gameOverScreen" class="overlay hidden">
            <div class="overlay-content">
                <h2 class="game-title">GAME OVER</h2>
                <p class="score-label">SAWS DODGED</p>
                <div class="final-score" id="finalScore">0</div>
                <p class="coins-collected" id="coinsCollected">0 COINS</p>
                <button class="btn" id="restartButton">RETRY</button>
                <button class="btn btn-secondary" id="menuButton">MENU</button>
            </div>
        </div>

        <!-- Pause Screen -->
        <div id="pauseScreen" class="overlay hidden">
            <div class="overlay-content">
                <h2 class="game-title">PAUSED</h2>
                <button class="btn" id="resumeButton">RESUME</button>
                <button class="btn btn-secondary" id="pauseRestartBtn">RESTART</button>
                <button class="btn btn-secondary" id="pauseMenuBtn">MENU</button>
            </div>
        </div>

        <!-- Settings Modal -->
        <div id="settingsModal" class="settings-modal hidden">
            <h3 class="settings-title">SETTINGS</h3>
            <div class="settings-row">
                <span class="settings-label">MUSIC</span>
                <div class="toggle active" id="musicToggle"></div>
            </div>
            <div class="settings-row">
                <span class="settings-label">SOUND FX</span>
                <div class="toggle active" id="fxToggle"></div>
            </div>
            <div class="settings-row">
                <span class="settings-label">HAPTICS</span>
                <div class="toggle active" id="hapticToggle"></div>
            </div>
            <button class="btn" id="settingsClose">DONE</button>
        </div>
    </div>

</body>
</html>
